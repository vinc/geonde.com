<% title "Electricity emissions" %>
<div class="container py-4">
  <h1 class="display-1 fw-bold mb-3"><%= link_to "Geonde", root_path, class: "text-primary" %></h1>

  <% if params["countries"] %>
    <h3>
      <%= link_to "Electricity emissions", electricity_emissions_path, class: "text-reset" %>
      in
      <%= pluralize(@countries.count, "country") %>
    </h3>

    <table class="table table-striped font-monospace">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col">Country</th>
          <th scope="col" class="text-end">Time</th>
          <th scope="col" class="text-end">Carbon Intensity</th>
        </tr>
      </thead>
      <tbody>
        <% @countries.each_with_index do |country, index| %>
          <tr>
            <th scope="row"><%= index + 1 %></th>
            <td><%= country.name %></td>
            <td class="text-end">
              <%= country.data.time.future? ? "+" : "-" %><%= time_ago(country.data.time) %>
            </td>
            <td class="text-end">
              <%= country.carbon_intensity %> gCO2eq/kWh
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>

    <p>
      <%= "Source".pluralize(@sources.count) %>:
      <% @sources.each_with_index do |source, index| %>
        <%= link_to_source source %><%= index < @sources.length - 1 ? "," : "" %>
      <% end %>
    </p>
  <% else %>
    <h3>Electricity emissions</h3>
    <ul class="columns">
      <% @countries.each do |country| %>
        <li><%= link_to country.name, "/electricity/emissions/#{country.code}" %></li>
      <% end %>
    </ul>
    <p>Data available for <%= pluralize(@total, "country") %></p>
  <% end %>
</div>
